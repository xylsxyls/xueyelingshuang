#pragma once
#include "CTaskThreadManager/CTaskThreadManagerAPI.h"
#include "CorrespondParam/CorrespondParamAPI.h"

class ProcessReceiveCallback;
class SharedMemory;

/** 接收任务
*/
class ReceiveTask : public CTask
{
public:
	/** 构造函数
	@param[in] buffer 数据首地址
	@param[in] length 长度
	*/
	ReceiveTask(const char* buffer, int32_t length);

	/** 析构函数
	*/
	~ReceiveTask();

public:
	/** 执行任务
	*/
	void DoTask();

	/** 设置参数
	@param [in] sendPid 发送者的pid
	@param [in] callback 接收回调类
	@param [in] protocolId 数据编码方式
	*/
	void setParam(int32_t sendPid,
		ProcessReceiveCallback* callback,
		CorrespondParam::ProtocolId protocolId);

private:
	int32_t m_sendPid;
	CorrespondParam::ProtocolId m_protocolId;
	ProcessReceiveCallback* m_callback;
	char* m_buffer;
	int32_t m_length;
};